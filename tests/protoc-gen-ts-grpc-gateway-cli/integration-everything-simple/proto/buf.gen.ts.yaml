version: v2
managed:
  enabled: true
plugins:
  # client, defaultConfig
  - local: protoc-gen-ts-grpc-gateway-cli
    out: ../defaultConfig
    opt:
      - paths=source_relative
  - remote: buf.build/community/stephenh-ts-proto
    out: ../defaultConfig
    opt:
      - env=browser
      - esModuleInterop=true
      - useOptionals=messages
      - outputServices=generic-definitions
      - outputServices=nice-grpc
      - outputEncodeMethods=false
      - outputJsonMethods=true
      - stringEnums=false
      - useExactTypes=false

  # client, useProtoNames
  - local: protoc-gen-ts-grpc-gateway-cli
    out: ../useProtoNames
    opt:
      - paths=source_relative
      - marshal_use_proto_names=true
  - remote: buf.build/community/stephenh-ts-proto
    out: ../useProtoNames
    opt:
      - env=browser
      - esModuleInterop=true
      - useOptionals=messages
      - outputServices=generic-definitions
      - outputServices=nice-grpc
      - outputEncodeMethods=false
      - outputJsonMethods=true
      - stringEnums=false
      - useExactTypes=false
      - snakeToCamel=keys # this is different from the defaultConfig

  # client, stringEnums
  # to test ts-proto stringEnums option work with protoc-gen-go-json
  - local: protoc-gen-ts-grpc-gateway-cli
    out: ../stringEnums
    opt:
      - paths=source_relative
  - remote: buf.build/community/stephenh-ts-proto
    out: ../stringEnums
    opt:
      - env=browser
      - esModuleInterop=true
      - useOptionals=messages
      - outputServices=generic-definitions
      - outputServices=nice-grpc
      - outputEncodeMethods=false
      - outputJsonMethods=true
      - stringEnums=true # this is different from the defaultConfig
      - useExactTypes=false
